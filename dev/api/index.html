<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · NeighborJoining.jl</title><meta name="title" content="API · NeighborJoining.jl"/><meta property="og:title" content="API · NeighborJoining.jl"/><meta property="twitter:title" content="API · NeighborJoining.jl"/><meta name="description" content="Documentation for NeighborJoining.jl."/><meta property="og:description" content="Documentation for NeighborJoining.jl."/><meta property="twitter:description" content="Documentation for NeighborJoining.jl."/><meta property="og:url" content="https://BenjaminDoran.github.io/NeighborJoining.jl/api/"/><meta property="twitter:url" content="https://BenjaminDoran.github.io/NeighborJoining.jl/api/"/><link rel="canonical" href="https://BenjaminDoran.github.io/NeighborJoining.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeighborJoining.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BenjaminDoran/NeighborJoining.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="NeighborJoining-Functions"><a class="docs-heading-anchor" href="#NeighborJoining-Functions">NeighborJoining Functions</a><a id="NeighborJoining-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#NeighborJoining-Functions" title="Permalink"></a></h1><ul><li><a href="#NeighborJoining.NJClust"><code>NeighborJoining.NJClust</code></a></li><li><a href="#NeighborJoining.heights-Tuple{NJClust}"><code>NeighborJoining.heights</code></a></li><li><a href="#NeighborJoining.merges-Tuple{NJClust}"><code>NeighborJoining.merges</code></a></li><li><a href="#NeighborJoining.newickstring"><code>NeighborJoining.newickstring</code></a></li><li><a href="#NeighborJoining.order-Tuple{NJClust}"><code>NeighborJoining.order</code></a></li><li><a href="#NeighborJoining.RegularNeighborJoining.regNJ-Tuple{AbstractMatrix{&lt;:Number}}"><code>NeighborJoining.RegularNeighborJoining.regNJ</code></a></li><li><a href="#NeighborJoining.FastNeighborJoining.fastNJ-Tuple{AbstractMatrix{&lt;:Number}}"><code>NeighborJoining.FastNeighborJoining.fastNJ</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.NJClust" href="#NeighborJoining.NJClust"><code>NeighborJoining.NJClust</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NJClust(merges::Matrix{M}, heights::Matrix{H})</code></pre><p>fields:</p><ul><li>merges is a n-1 x 2 matrix of integers: absolute values of negative integers indicate index into the distance matrix (i.e., leaves). positive integers are the index into the merge list (i.e., the kth internal node)</li><li>heights is an n-1 x 2 matrix where each value is the distance from the left (1) or right (2) chield from its parent. Specifically <code>heights[i,j]</code> is the <code>j</code>th childs distance to the parent node, row <code>i</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/NeighborJoining.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.heights-Tuple{NJClust}" href="#NeighborJoining.heights-Tuple{NJClust}"><code>NeighborJoining.heights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">heights(t::NJClust)</code></pre><p>extracts the heights list from NJClust object. rowindex is the internal node id, and each column represents the distance from the internal node to it&#39;s left and right child respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/NeighborJoining.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.merges-Tuple{NJClust}" href="#NeighborJoining.merges-Tuple{NJClust}"><code>NeighborJoining.merges</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merges(t::NJClust)</code></pre><p>extracts the merge list from NJClust object. rowindex is the internal node id, and each column represents the children nodes. Leaf nodes are represented by negative integers corresponding to the index in the original distance matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/NeighborJoining.jl#L17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.newickstring" href="#NeighborJoining.newickstring"><code>NeighborJoining.newickstring</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">newickstring(njc::NJClust, tiplabels=AbstractVector{&lt;:String}; labelinternalnodes=false)
newickstring(merges::AbstractArray{&lt;:Integer}, heights::AbstractArray{&lt;:AbstractFloat}, tiplabels::AbstractVector{&lt;:String}; labelinternalnodes=false)</code></pre><p>Converts a list of merges into a newicktree formatted string.</p><p><strong>args:</strong></p><ul><li>njc: is a struct that has merges and heights</li><li>merges and heights from a NJClust struct:<ul><li>merges is a n-1 x 2 matrix of integers: absolute values of negative integers indicate index into the distance matrix (i.e., leaves). positive integers are the index into the merge list (i.e., the kth internal node)</li><li>heights is an n-1 x 2 matrix where each value is the distance from the left (1) or right (2) chield from its parent. Specifically <code>heights[i,j]</code> is the <code>j</code>th childs distance to the parent node, row <code>i</code>.</li></ul></li><li>tiplabels: vector of string labels corresponding to the order of leaves in the distance matrix</li><li>labelinternalnodes: whether to generate node labels for the internal nodes. defaults to <code>false</code>.</li></ul><p><strong>returns:</strong></p><ul><li>newicktree formatted string</li></ul><p><strong>example:</strong></p><pre><code class="language-julia-repl hljs">julia&gt; d = [
           0  5  9  9 8
           5  0 10 10 9
           9 10  0  8 7
           9 10  8  0 3
           8  9  7  3 0
       ];

julia&gt; njclusts = regNJ(d)
NJClust{Int64, Float64}([-2 -1; -3 1; -4 2; -5 3], [3.0 2.0; 4.0 3.0; 2.0 2.0; 0.5 0.5])

julia&gt; nwstring = newickstring(njclusts)
&quot;(5:5.000000e-01,(4:2.000000e+00,(3:4.000000e+00,(2:3.000000e+00,1:2.000000e+00):3.000000e+00):2.000000e+00):5.000000e-01):0.000000e+00;&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/newickstring.jl#L5-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.order-Tuple{NJClust}" href="#NeighborJoining.order-Tuple{NJClust}"><code>NeighborJoining.order</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">order(clust::NJClust)</code></pre><p>Returns the left-to-right order of leaf nodes (tips) in the phylogenetic tree.</p><p>Performs a depth-first traversal of the tree structure to determine the order in which leaf nodes appear when reading the tree from left to right. This is useful for plotting or arranging data according to the tree topology.</p><p><strong>Arguments</strong></p><ul><li><code>clust::NJClust</code>: A neighbor-joining clustering result containing the tree structure with merges and heights matrices</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: A vector of integers representing the indices of leaf nodes in their left-to-right order in the tree. The indices correspond to the original positions in the distance matrix used to construct the tree.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; d = [
           0  5  9  9 8
           5  0 10 10 9
           9 10  0  8 7
           9 10  8  0 3
           8  9  7  3 0
       ];

julia&gt; njclusts = regNJ(d)
NJClust{Int64, Float64}([-2 -1; -3 1; -4 2; -5 3], [3.0 2.0; 4.0 3.0; 2.0 2.0; 0.5 0.5])

julia&gt; leaf_order = order(njclusts)
5-element Vector{Int64}:
 5
 4
 3
 2
 1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/NeighborJoining.jl#L33-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.RegularNeighborJoining.regNJ-Tuple{AbstractMatrix{&lt;:Number}}" href="#NeighborJoining.RegularNeighborJoining.regNJ-Tuple{AbstractMatrix{&lt;:Number}}"><code>NeighborJoining.RegularNeighborJoining.regNJ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">regNJ(d::AbstractMatrix{&lt;:Number})</code></pre><p>regNJ algorithm is the traditional NeighborJoining algorithm from </p><blockquote><p>Saitou, N. &amp; Nei, M. The neighbor-joining method: a new method for reconstructing phylogenetic trees. Molecular Biology and Evolution 4, 406-425 (1987).</p></blockquote><p>This algorithm is guarenteed to infer the tree for additive distance matrices, but it does have an algorithmic complexity of <code>O(n^3)</code>, so it can be slow for distance matrices on the order of &gt;10³.</p><p>args:</p><ul><li>d is an n by n square symetric distance matrix</li></ul><p>returns:</p><ul><li>NJClust struct with fields merges and heights</li></ul><p>examples:</p><pre><code class="language- hljs">julia&gt; d = [
           0  5  9  9 8
           5  0 10 10 9
           9 10  0  8 7
           9 10  8  0 3
           8  9  7  3 0
       ];

julia&gt; njclusts = regNJ(d)
NJClust{Int64, Float64}([-2 -1; -3 1; -4 2; -5 3], [3.0 2.0; 4.0 3.0; 2.0 2.0; 0.5 0.5])

julia&gt; nwstring = newickstring(njclusts)
&quot;(5:5.000000e-01,(4:2.000000e+00,(3:4.000000e+00,(2:3.000000e+00,1:2.000000e+00):3.000000e+00):2.000000e+00):5.000000e-01):0.000000e+00;&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/RegularNeighborJoining.jl#L10-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NeighborJoining.FastNeighborJoining.fastNJ-Tuple{AbstractMatrix{&lt;:Number}}" href="#NeighborJoining.FastNeighborJoining.fastNJ-Tuple{AbstractMatrix{&lt;:Number}}"><code>NeighborJoining.FastNeighborJoining.fastNJ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastNJ(d::AbstractMatrix{&lt;:Number})</code></pre><p>fastNJ algorithm finds k independent pairs to merge and merges them for each iteration.  This is significantly faster because it is not recalculating the full pairwise Q for each pair joined.</p><p>This algorithm is nearly additive, but there are instances where the topology  &#39;(a,(b,(c,d)))&#39; is inferred as &#39;((a,b), (c,d))&#39;. This happens when  &#39;b&#39; is not as close to &#39;c&#39; or &#39;d&#39; as it is to &#39;a&#39;,  but &#39;b&#39; is closer to the common ancestor &#39;(c,d)&#39; than it is to &#39;a&#39;.</p><p>args:</p><ul><li>d is an n by n square symetric distance matrix</li></ul><p>returns:</p><ul><li>NJClust struct with fields merges and heights</li></ul><pre><code class="language- hljs">julia&gt; d = [
           0  5  9  9 8
           5  0 10 10 9
           9 10  0  8 7
           9 10  8  0 3
           8  9  7  3 0
       ];

julia&gt; njclusts = fastNJ(d)
NJClust{Int64, Float64}([-2 -1; -5 -4; 1 -3; 3 2], [3.0 2.0; 1.0 2.0; 3.0 4.0; 1.0 1.0])

julia&gt; nwstring = newickstring(njclusts)
&quot;(5:5.000000e-01,(4:2.000000e+00,(3:4.000000e+00,(2:3.000000e+00,1:2.000000e+00):3.000000e+00):2.000000e+00):5.000000e-01):0.000000e+00;&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/BenjaminDoran/NeighborJoining.jl/blob/a0ab1f70f2c1d83f939a2977d26680d761bb143c/src/FastNeighborJoining.jl#L7-L40">source</a></section></article><p>&lt;!– <code>@docs NJClust regNJ fastNJ newickstring</code> –&gt;</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 9 July 2025 23:05">Wednesday 9 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
